variables:
  DOCKER_HOST: tcp://docker:2375
  DOCKER_DRIVER: overlay2

image: docker:stable
services:
  - docker:dind

stages:
  - build
  - test

before_script:
  - apk update
  - apk add bash

build_rails_app:
  stage: build
  artifacts:
    paths:
      - rails6Hci
      - tmp
  script:
    - bash ci0.sh
    - bash ci1.sh

test_rails_app:
  stage: test
  dependencies: 
    - build_rails_app
  script:
    - bash ci2.sh
